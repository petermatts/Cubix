cmake_minimum_required(VERSION 3.15)
project(Cubix LANGUAGES CXX)

# Enable SWIG and Python
find_package(SWIG REQUIRED)
include(${SWIG_USE_FILE})
find_package(Python3 REQUIRED COMPONENTS Interpreter Development)

# Use C++17 or later
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Add the main source directory
include_directories(${CMAKE_CURRENT_SOURCE_DIR}/src)

# Create a shared library for core logic
add_library(cubix_core
    src/cube.cpp
    src/moves.cpp
)

target_include_directories(cubix_core PUBLIC src)

# SWIG configuration
set_source_files_properties(interface.i PROPERTIES CPLUSPLUS ON)
set(CMAKE_SWIG_FLAGS "")

swig_add_library(rubik
    LANGUAGE python
    TYPE MODULE
    SOURCES interface.i
)

# Link SWIG module with Python and core logic
target_include_directories(rubik PRIVATE ${Python3_INCLUDE_DIRS})
swig_link_libraries(rubik ${Python3_LIBRARIES} cubix_core)

add_executable(cubix main.cpp)
target_link_libraries(cubix PRIVATE cubix_core)

add_subdirectory(tests)